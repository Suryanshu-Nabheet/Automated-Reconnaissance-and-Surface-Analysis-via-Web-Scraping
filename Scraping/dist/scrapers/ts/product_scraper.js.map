{"version":3,"file":"product_scraper.js","sourceRoot":"","sources":["../../../src/scrapers/ts/product_scraper.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Product Scraper\n * \n * This module implements a product scraper for e-commerce websites.\n * It extracts product information including prices, variants, and image galleries.\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport * as puppeteer from 'puppeteer';\nimport axios from 'axios';\nimport * as cheerio from 'cheerio';\nimport * as winston from 'winston';\nimport { z } from 'zod';\nimport * as yaml from 'yaml';\n\n// Setup command line arguments parsing\nimport yargs from 'yargs';\nimport { hideBin } from 'yargs/helpers';\n\n/**\n * Configuration interface for the product scraper\n */\ninterface ScraperConfig {\n  url: string;\n  selectors: {\n    productTitle: string;\n    price: string;\n    description: string;\n    images: string;\n    variants: string;\n    reviews: string;\n    rating: string;\n    sku: string;\n    stock: string;\n    relatedProducts?: string;\n  };\n  options?: {\n    maxRelatedProducts?: number;\n    maxReviews?: number;\n    maxImages?: number;\n    delay?: number;\n    timeout?: number;\n    headless?: boolean;\n    waitForSelector?: string;\n    currency?: string;\n    scrollToBottom?: boolean;\n    waitForNetworkIdle?: boolean;\n  };\n}\n\n/**\n * Output paths interface\n */\ninterface OutputPaths {\n  data: string;\n  exports: string;\n  schemas: string;\n}\n\n/**\n * Product variant interface\n */\ninterface ProductVariant {\n  name: string;\n  value: string;\n  price?: string;\n  currency?: string;\n  available: boolean;\n  sku?: string;\n}\n\n/**\n * Product review interface\n */\ninterface ProductReview {\n  author: string;\n  rating: number;\n  date: string;\n  title?: string;\n  text: string;\n  helpful?: number;\n}\n\n/**\n * Product price interface\n */\ninterface ProductPrice {\n  amount: number;\n  currency: string;\n  formatted: string;\n  discounted: boolean;\n  originalAmount?: number;\n  originalFormatted?: string;\n  discountPercentage?: number;\n}\n\n/**\n * Product image interface\n */\ninterface ProductImage {\n  url: string;\n  alt: string;\n  isMain: boolean;\n  thumbnailUrl?: string;\n  position: number;\n}\n\n/**\n * Interface for scraped products\n */\ninterface ScrapedProduct {\n  title: string;\n  url: string;\n  sku: string;\n  description: string;\n  shortDescription?: string;\n  price: ProductPrice;\n  images: ProductImage[];\n  variants: ProductVariant[];\n  reviews: ProductReview[];\n  rating: {\n    average: number;\n    count: number;\n    distribution?: Record<string, number>;\n  };\n  metadata: {\n    brand?: string;\n    category?: string;\n    inStock: boolean;\n    stockLevel?: string | number;\n    shippingInfo?: string;\n    tags: string[];\n  };\n  relatedProducts: {\n    title: string;\n    url: string;\n    price?: string;\n    imageUrl?: string;\n  }[];\n  timestamp: string;\n}\n\n/**\n * Interface for scraper statistics\n */\ninterface ScraperStats {\n  start_time: string;\n  end_time?: string;\n  elapsed_seconds?: number;\n  pages_visited: number;\n  products_scraped: number;\n  images_found: number;\n  variants_found: number;\n  reviews_processed: number;\n  related_products_found: number;\n  errors: number;\n  bytes_downloaded: number;\n}\n\n/**\n * Interface for scraper results\n */\ninterface ScraperResult {\n  success: boolean;\n  items_scraped: number;\n  stats: ScraperStats;\n  error?: string;\n}\n\n/**\n * Schema validation for scraped products using Zod\n */\nconst ProductPriceSchema = z.object({\n  amount: z.number(),\n  currency: z.string(),\n  formatted: z.string(),\n  discounted: z.boolean(),\n  originalAmount: z.number().optional(),\n  originalFormatted: z.string().optional(),\n  discountPercentage: z.number().optional()\n});\n\nconst ProductImageSchema = z.object({\n  url: z.string().url(),\n  alt: z.string(),\n  isMain: z.boolean(),\n  thumbnailUrl: z.string().url().optional(),\n  position: z.number()\n});\n\nconst ProductVariantSchema = z.object({\n  name: z.string(),\n  value: z.string(),\n  price: z.string().optional(),\n  currency: z.string().optional(),\n  available: z.boolean(),\n  sku: z.string().optional()\n});\n\nconst ProductReviewSchema = z.object({\n  author: z.string(),\n  rating: z.number().min(0).max(5),\n  date: z.string(),\n  title: z.string().optional(),\n  text: z.string(),\n  helpful: z.number().optional()\n});\n\nconst ScrapedProductSchema = z.object({\n  title: z.string(),\n  url: z.string().url(),\n  sku: z.string(),\n  description: z.string(),\n  shortDescription: z.string().optional(),\n  price: ProductPriceSchema,\n  images: z.array(ProductImageSchema),\n  variants: z.array(ProductVariantSchema),\n  reviews: z.array(ProductReviewSchema),\n  rating: z.object({\n    average: z.number().min(0).max(5),\n    count: z.number().min(0),\n    distribution: z.record(z.string(), z.number()).optional()\n  }),\n  metadata: z.object({\n    brand: z.string().optional(),\n    category: z.string().optional(),\n    inStock: z.boolean(),\n    stockLevel: z.union([z.string(), z.number()]).optional(),\n    shippingInfo: z.string().optional(),\n    tags: z.array(z.string())\n  }),\n  relatedProducts: z.array(\n    z.object({\n      title: z.string(),\n      url: z.string().url(),\n      price: z.string().optional(),\n      imageUrl: z.string().url().optional()\n    })\n  ),\n  timestamp: z.string().datetime()\n});\n\n/**\n * Setup logging\n */\nconst logger = winston.createLogger({\n  level: 'info',\n  format: winston.format.combine(\n    winston.format.timestamp(),\n    winston.format.printf(({ level, message, timestamp }) => {\n      return `${timestamp} - ${level.toUpperCase()}: ${message}`;\n    })\n  ),\n  transports: [\n    new winston.transports.Console()\n  ]\n});\n\n/**\n * Product scraper class\n */\nclass ProductScraper {\n  private config: ScraperConfig;\n  private outputPaths: OutputPaths;\n  private stats: ScraperStats;\n  private browser: puppeteer.Browser | null = null;\n\n  /**\n   * Constructor\n   * @param config Scraper configuration\n   * @param outputPaths Output directory paths\n   */\n  constructor(config: ScraperConfig, outputPaths: OutputPaths) {\n    this.config = config;\n    this.outputPaths = outputPaths;\n    this.stats = {\n      start_time: new Date().toISOString(),\n      pages_visited: 0,\n      products_scraped: 0,\n      images_found: 0,\n      variants_found: 0,\n      reviews_processed: 0,\n      related_products_found: 0,\n      errors: 0,\n      bytes_downloaded: 0\n    };\n\n    // Create output directories if they don't exist\n    Object.values(outputPaths).forEach(dir => {\n      if (!fs.existsSync(dir)) {\n        fs.mkdirSync(dir, { recursive: true });\n      }\n    });\n\n    // Save the schema definition\n    const schemaPath = path.join(outputPaths.schemas, 'product_schema.json');\n    fs.writeFileSync(\n      schemaPath, \n      JSON.stringify({\n        $schema: \"http://json-schema.org/draft-07/schema#\",\n        type: \"object\",\n        properties: {\n          title: { type: \"string\" },\n          url: { type: \"string\", format: \"uri\" },\n          sku: { type: \"string\" },\n          description: { type: \"string\" },\n          price: {\n            type: \"object\",\n            properties: {\n              amount: { type: \"number\" },\n              currency: { type: \"string\" },\n              formatted: { type: \"string\" },\n              discounted: { type: \"boolean\" }\n            },\n            required: [\"amount\", \"currency\", \"formatted\", \"discounted\"]\n          },\n          images: {\n            type: \"array\",\n            items: {\n              type: \"object\",\n              properties: {\n                url: { type: \"string\", format: \"uri\" },\n                alt: { type: \"string\" },\n                isMain: { type: \"boolean\" }\n              }\n            }\n          },\n          variants: {\n            type: \"array\",\n            items: {\n              type: \"object\",\n              properties: {\n                name: { type: \"string\" },\n                value: { type: \"string\" },\n                available: { type: \"boolean\" }\n              }\n            }\n          }\n        },\n        required: [\"title\", \"url\", \"sku\", \"price\"]\n      }, null, 2)\n    );\n\n    logger.info(`Initialized product scraper with target URL: ${this.config.url || 'Not specified'}`);\n  }\n\n  /**\n   * Parse a price string into a structured price object\n   * @param priceText The price text to parse\n   * @param currencySymbol Optional currency symbol to use\n   * @returns Structured price object\n   */\n  private parsePrice(priceText: string, currencySymbol?: string): ProductPrice {\n    if (!priceText) {\n      return {\n        amount: 0,\n        currency: currencySymbol || 'USD',\n        formatted: '$0.00',\n        discounted: false\n      };\n    }\n\n    try {\n      // Clean the price text\n      const cleanText = priceText.trim();\n      \n      // Check if there's a discounted price\n      const hasDiscount = cleanText.includes('$') && (cleanText.match(/\\$/g) || []).length > 1;\n      \n      // Default values\n      let amount = 0;\n      let currency = currencySymbol || 'USD';\n      let formatted = cleanText;\n      let originalAmount: number | undefined;\n      let originalFormatted: string | undefined;\n      let discountPercentage: number | undefined;\n      \n      // Extract the current price\n      const priceMatch = cleanText.match(/([₹$€£¥])\\s*([0-9,]+(\\.[0-9]{2})?)/);\n      if (priceMatch) {\n        currency = this.getCurrencyCode(priceMatch[1]);\n        amount = parseFloat(priceMatch[2].replace(/,/g, ''));\n        formatted = `${priceMatch[1]}${priceMatch[2]}`;\n      } else {\n        // Try to extract just numbers\n        const numericMatch = cleanText.match(/([0-9,]+(\\.[0-9]{2})?)/);\n        if (numericMatch) {\n          amount = parseFloat(numericMatch[1].replace(/,/g, ''));\n          formatted = `${currencySymbol || '$'}${numericMatch[1]}`;\n        }\n      }\n      \n      // If there's a discount, extract the original price\n      if (hasDiscount) {\n        const originalMatch = cleanText.match(/([₹$€£¥])\\s*([0-9,]+(\\.[0-9]{2})?).*([₹$€£¥])\\s*([0-9,]+(\\.[0-9]{2})?)/);\n        if (originalMatch) {\n          // Determine which price is higher (original)\n          const price1 = parseFloat(originalMatch[2].replace(/,/g, ''));\n          const price2 = parseFloat(originalMatch[5].replace(/,/g, ''));\n          \n          if (price1 > price2) {\n            originalAmount = price1;\n            originalFormatted = `${originalMatch[1]}${originalMatch[2]}`;\n            amount = price2;\n            formatted = `${originalMatch[4]}${originalMatch[5]}`;\n          } else {\n            originalAmount = price2;\n            originalFormatted = `${originalMatch[4]}${originalMatch[5]}`;\n            amount = price1;\n            formatted = `${originalMatch[1]}${originalMatch[2]}`;\n          }\n          \n          // Calculate discount percentage\n          if (originalAmount > 0) {\n            discountPercentage = Math.round(((originalAmount - amount) / originalAmount) * 100);\n          }\n        }\n      }\n      \n      return {\n        amount,\n        currency,\n        formatted,\n        discounted: hasDiscount,\n        originalAmount,\n        originalFormatted,\n        discountPercentage\n      };\n    } catch (error) {\n      logger.warn(`Error parsing price \"${priceText}\": ${error instanceof Error ? error.message : String(error)}`);\n      return {\n        amount: 0,\n        currency: currencySymbol || 'USD',\n        formatted: priceText,\n        discounted: false\n      };\n    }\n  }\n\n  /**\n   * Convert currency symbol to ISO currency code\n   * @param symbol Currency symbol\n   * @returns ISO currency code\n   */\n  private getCurrencyCode(symbol: string): string {\n    const currencyMap: Record<string, string> = {\n      '$': 'USD',\n      '€': 'EUR',\n      '£': 'GBP',\n      '¥': 'JPY',\n      '₹': 'INR',\n      '₽': 'RUB',\n      '₩': 'KRW',\n      '₫': 'VND',\n      '฿': 'THB',\n      '₴': 'UAH',\n      '₺': 'TRY'\n    };\n    \n    return currencyMap[symbol] || 'USD';\n  }\n\n  /**\n   * Extract star rating from text or element class\n   * @param ratingText Rating text or class to parse\n   * @returns Rating value (0-5)\n   */\n  private parseRating(ratingText: string): number {\n    try {\n      // Check for numeric value in text\n      const numericMatch = ratingText.match(/([0-9]\\.[0-9]|[0-5])/);\n      if (numericMatch) {\n        return parseFloat(numericMatch[1]);\n      }\n      \n      // Check for star representations (e.g., \"★★★☆☆\" or \"***--\")\n      const fullStars = (ratingText.match(/★/g) || []).length + (ratingText.match(/\\*/g) || []).length;\n      const emptyStars = (ratingText.match(/☆/g) || []).length + (ratingText.match(/-/g) || []).length;\n      \n      if (fullStars > 0 || emptyStars > 0) {\n        return fullStars / (fullStars + emptyStars) * 5;\n      }\n      \n      // Check for percentage (e.g., \"80%\")\n      const percentMatch = ratingText.match(/([0-9]+)%/);\n      if (percentMatch) {\n        return Math.round(parseInt(percentMatch[1]) / 20 * 100) / 100;\n      }\n      \n      return 0;\n    } catch (error) {\n      return 0;\n    }\n  }\n\n  /**\n   * Scrape a product using Puppeteer\n   * @returns Promise resolving to the scraped product\n   */\n  async scrapeWithPuppeteer(): Promise<ScrapedProduct | null> {\n    const targetUrl = this.config.url || 'https://shop.example.com';\n    const selectors = this.config.selectors;\n    const options = this.config.options || {};\n    \n    logger.info(`Starting Puppeteer product scrape of ${targetUrl}`);\n    \n    try {\n      // Launch browser\n      this.browser = await puppeteer.launch({\n        headless: options.headless !== false,\n        args: ['--no-sandbox', '--disable-setuid-sandbox']\n      });\n      \n      // Open new page\n      const page = await this.browser.newPage();\n      \n      // Set default timeout\n      page.setDefaultTimeout(options.timeout || 30000);\n      \n      // Set user agent\n      await page.setUserAgent('Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36');\n      \n      // Go to URL\n      await page.goto(targetUrl, { \n        waitUntil: options.waitForNetworkIdle ? 'networkidle2' : 'domcontentloaded' \n      });\n      \n      // Wait for specific selector if configured\n      if (options.waitForSelector) {\n        await page.waitForSelector(options.waitForSelector, { timeout: options.timeout || 30000 });\n      }\n      \n      // Scroll to bottom if configured (useful for lazy-loaded content)\n      if (options.scrollToBottom) {\n        await this.autoScroll(page);\n      }\n      \n      // Update stats\n      this.stats.pages_visited++;\n      \n      // Get page content size\n      const content = await page.content();\n      this.stats.bytes_downloaded += content.length;\n      \n      logger.info(`Successfully loaded ${targetUrl}`);\n      \n      // Extract basic product data\n      const productTitle = await this.extractText(page, selectors.productTitle);\n      const priceText = await this.extractText(page, selectors.price);\n      const description = await this.extractText(page, selectors.description);\n      const sku = await this.extractText(page, selectors.sku);\n      const stockText = await this.extractText(page, selectors.stock);\n      \n      // Parse stock status\n      const inStock = this.parseStockStatus(stockText);\n      \n      // Parse price\n      const price = this.parsePrice(priceText, options.currency);\n      \n      // Extract images\n      const images = await this.extractImages(page, selectors.images, options.maxImages || 10);\n      this.stats.images_found += images.length;\n      \n      // Extract variants\n      const variants = await this.extractVariants(page, selectors.variants);\n      this.stats.variants_found += variants.length;\n      \n      // Extract reviews\n      const reviews = await this.extractReviews(page, selectors.reviews, selectors.rating, options.maxReviews || 5);\n      this.stats.reviews_processed += reviews.length;\n      \n      // Extract rating\n      const rating = await this.extractRating(page, selectors.rating, reviews);\n      \n      // Extract related products\n      const relatedProducts = await this.extractRelatedProducts(page, selectors.relatedProducts || '.related-products .product', options.maxRelatedProducts || 5);\n      this.stats.related_products_found += relatedProducts.length;\n      \n      // Create short description (first 200 chars)\n      const shortDescription = description.length > 200 \n        ? description.substring(0, 200).trim() + '...'\n        : description;\n      \n      // Create product object\n      const product: ScrapedProduct = {\n        title: productTitle || 'Unknown Product',\n        url: targetUrl,\n        sku: sku || 'UNKNOWN',\n        description,\n        shortDescription,\n        price,\n        images,\n        variants,\n        reviews,\n        rating,\n        metadata: {\n          inStock,\n          stockLevel: this.parseStockLevel(stockText),\n          tags: []\n        },\n        relatedProducts,\n        timestamp: new Date().toISOString()\n      };\n      \n      // Update stats\n      this.stats.products_scraped++;\n      logger.info(`Successfully scraped product: ${product.title}`);\n      \n      return product;\n    } catch (error) {\n      this.stats.errors++;\n      logger.error(`Puppeteer scraping error: ${error instanceof Error ? error.message : String(error)}`);\n      if (error instanceof Error && error.stack) {\n        logger.error(`Stack trace: ${error.stack}`);\n      }\n      return null;\n    } finally {\n      // Close browser\n      if (this.browser) {\n        await this.browser.close();\n        this.browser = null;\n      }\n    }\n  }\n\n  /**\n   * Helper to extract text from a selector\n   */\n  private async extractText(page: puppeteer.Page, selector: string): Promise<string> {\n    try {\n      const element = await page.$(selector);\n      if (element) {\n        const textContent = await page.evaluate(el => el.textContent, element);\n        return (textContent || '').trim();\n      }\n      return '';\n    } catch (error) {\n      logger.debug(`Error extracting text from ${selector}: ${error instanceof Error ? error.message : String(error)}`);\n      return '';\n    }\n  }\n\n  /**\n   * Helper to auto-scroll a page to the bottom\n   */\n  private async autoScroll(page: puppeteer.Page): Promise<void> {\n    await page.evaluate(async () => {\n      await new Promise<void>((resolve) => {\n        let totalHeight = 0;\n        const distance = 100;\n        const timer = setInterval(() => {\n          const scrollHeight = document.body.scrollHeight;\n          window.scrollBy(0, distance);\n          totalHeight += distance;\n          \n          if (totalHeight >= scrollHeight) {\n            clearInterval(timer);\n            resolve();\n          }\n        }, 100);\n      });\n    });\n  }\n\n  /**\n   * Extract product images\n   */\n  private async extractImages(page: puppeteer.Page, selector: string, maxImages: number): Promise<ProductImage[]> {\n    try {\n      return await page.evaluate((selector, maxImages) => {\n        const images: ProductImage[] = [];\n        const imageElements = document.querySelectorAll(selector);\n        \n        // Handle case where selector finds <img> tags directly\n        if (imageElements[0]?.tagName === 'IMG') {\n          Array.from(imageElements).slice(0, maxImages).forEach((img, index) => {\n            const imgElement = img as HTMLImageElement;\n            images.push({\n              url: imgElement.src,\n              alt: imgElement.alt || '',\n              isMain: index === 0,\n              thumbnailUrl: imgElement.dataset.thumbnail,\n              position: index\n            });\n          });\n        } \n        // Handle case where selector finds containers with background images\n        else {\n          Array.from(imageElements).slice(0, maxImages).forEach((container, index) => {\n            // Try to find img inside container\n            const imgElement = container.querySelector('img');\n            if (imgElement) {\n              images.push({\n                url: imgElement.src,\n                alt: imgElement.alt || '',\n                isMain: index === 0,\n                thumbnailUrl: imgElement.dataset.thumbnail,\n                position: index\n              });\n            } \n            // Try to extract background image\n            else {\n              const style = window.getComputedStyle(container);\n              const bgImage = style.backgroundImage;\n              if (bgImage && bgImage !== 'none') {\n                const url = bgImage.replace(/url\\(['\"]?([^'\"]+)['\"]?\\)/gi, '$1');\n                images.push({\n                  url,\n                  alt: container.getAttribute('title') || container.getAttribute('aria-label') || '',\n                  isMain: index === 0,\n                  position: index\n                });\n              }\n            }\n          });\n        }\n        \n        return images;\n      }, selector, maxImages);\n    } catch (error) {\n      logger.error(`Error extracting images: ${error instanceof Error ? error.message : String(error)}`);\n      return [];\n    }\n  }\n\n  /**\n   * Extract product variants\n   */\n  private async extractVariants(page: puppeteer.Page, selector: string): Promise<ProductVariant[]> {\n    try {\n      return await page.evaluate((selector) => {\n        const variants: ProductVariant[] = [];\n        \n        // Look for select dropdowns first\n        const selectElements = document.querySelectorAll(`${selector} select`);\n        if (selectElements.length > 0) {\n          selectElements.forEach(select => {\n            const variantName = select.getAttribute('name') || \n                               select.getAttribute('id') || \n                               select.getAttribute('aria-label') || \n                               'Option';\n            \n            Array.from(select.options).forEach(option => {\n              if (option.value && !option.disabled) {\n                variants.push({\n                  name: variantName,\n                  value: option.textContent?.trim() || option.value,\n                  price: option.dataset.price,\n                  available: !option.disabled,\n                  sku: option.dataset.sku\n                });\n              }\n            });\n          });\n        }\n        \n        // Look for radio buttons and checkboxes\n        const inputElements = document.querySelectorAll(`${selector} input[type=\"radio\"], ${selector} input[type=\"checkbox\"]`);\n        if (inputElements.length > 0) {\n          const groupedInputs: Record<string, HTMLInputElement[]> = {};\n          \n          inputElements.forEach(input => {\n            const inputElement = input as HTMLInputElement;\n            const name = inputElement.name;\n            \n            if (!groupedInputs[name]) {\n              groupedInputs[name] = [];\n            }\n            \n            groupedInputs[name].push(inputElement);\n          });\n          \n          Object.entries(groupedInputs).forEach(([name, inputs]) => {\n            inputs.forEach(input => {\n              const label = document.querySelector(`label[for=\"${input.id}\"]`);\n              const valueText = label?.textContent?.trim() || input.value;\n              \n              variants.push({\n                name,\n                value: valueText,\n                available: !input.disabled,\n                sku: input.dataset.sku\n              });\n            });\n          });\n        }\n        \n        // Look for swatch elements or variant buttons\n        const swatchElements = document.querySelectorAll(`${selector} .swatch, ${selector} .variant-option, ${selector} .color-option`);\n        if (swatchElements.length > 0) {\n          // Try to determine variant type from container\n          const container = swatchElements[0].parentElement;\n          const variantName = container?.querySelector('label, .label, .option-name')?.textContent?.trim() || 'Option';\n          \n          swatchElements.forEach(swatch => {\n            const value = swatch.getAttribute('title') || \n                         swatch.getAttribute('data-value') || \n                         swatch.textContent?.trim() || \n                         '';\n                         \n            const available = !swatch.classList.contains('disabled') && \n                             !swatch.classList.contains('sold-out') &&\n                             !swatch.hasAttribute('disabled');\n                             \n            variants.push({\n              name: variantName,\n              value,\n              available,\n              sku: swatch.getAttribute('data-sku')\n            });\n          });\n        }\n        \n        return variants;\n      }, selector);\n    } catch (error) {\n      logger.error(`Error extracting variants: ${error instanceof Error ? error.message : String(error)}`);\n      return [];\n    }\n  }\n\n  /**\n   * Extract product reviews\n   */\n  private async extractReviews(page: puppeteer.Page, reviewSelector: string, ratingSelector: string, maxReviews: number): Promise<ProductReview[]> {\n    try {\n      return await page.evaluate((reviewSelector, ratingSelector, maxReviews) => {\n        const reviews: ProductReview[] = [];\n        const reviewElements = document.querySelectorAll(reviewSelector);\n        \n        Array.from(reviewElements).slice(0, maxReviews).forEach(review => {\n          // Try to find common review elements\n          const authorElement = review.querySelector('.author, .reviewer, .user, [itemprop=\"author\"]');\n          const dateElement = review.querySelector('.date, .review-date, [itemprop=\"datePublished\"]');\n          const titleElement = review.querySelector('.title, .review-title, [itemprop=\"name\"]');\n          const textElement = review.querySelector('.text, .content, .review-text, [itemprop=\"reviewBody\"]');\n          const ratingElement = review.querySelector(ratingSelector + ', .rating, .stars, [itemprop=\"ratingValue\"]');\n          \n          // Extract values\n          const author = authorElement?.textContent?.trim() || 'Anonymous';\n          const date = dateElement?.textContent?.trim() || new Date().toISOString().split('T')[0];\n          const title = titleElement?.textContent?.trim();\n          const text = textElement?.textContent?.trim() || '';\n          \n          // Extract rating\n          let rating = 0;\n          if (ratingElement) {\n            const ratingText = ratingElement.textContent?.trim() || '';\n            const ratingValue = ratingElement.getAttribute('data-rating') || '';\n            \n            if (ratingValue && !isNaN(parseFloat(ratingValue))) {\n              rating = parseFloat(ratingValue);\n            } else if (ratingText.match(/[0-5](\\.[0-9])?\\/5/)) {\n              // Format: \"4.5/5\"\n              rating = parseFloat(ratingText.split('/')[0]);\n            } else if (ratingText.match(/[0-9](\\.[0-9])?/)) {\n              // Simple number\n              rating = parseFloat(ratingText);\n            } else {\n              // Count stars in the element\n              const fullStars = ratingElement.querySelectorAll('.full-star, .star-full, .star.filled').length;\n              const halfStars = ratingElement.querySelectorAll('.half-star, .star-half').length;\n              const totalStars = ratingElement.querySelectorAll('.star, .star-container > *').length || 5;\n              \n              if (fullStars > 0 || halfStars > 0) {\n                rating = (fullStars + halfStars * 0.5) / (totalStars / 5);\n              }\n            }\n          }\n          \n          // Clamp rating between 0-5\n          rating = Math.max(0, Math.min(5, rating));\n          \n          // Find helpful votes\n          const helpfulElement = review.querySelector('.helpful-count, .helpful, .vote-count');\n          const helpful = helpfulElement ? parseInt(helpfulElement.textContent?.replace(/[^\\d]/g, '') || '0') : undefined;\n          \n          reviews.push({\n            author,\n            rating,\n            date,\n            title,\n            text,\n            helpful\n          });\n        });\n        \n        return reviews;\n      }, reviewSelector, ratingSelector, maxReviews);\n    } catch (error) {\n      logger.error(`Error extracting reviews: ${error instanceof Error ? error.message : String(error)}`);\n      return [];\n    }\n  }\n\n  /**\n   * Extract product rating\n   */\n  private async extractRating(page: puppeteer.Page, selector: string, reviews: ProductReview[]): Promise<ScrapedProduct['rating']> {\n    try {\n      const ratingData = await page.evaluate((selector) => {\n        // Try to find the average rating\n        const ratingElement = document.querySelector(selector + ', .rating, .product-rating, [itemprop=\"ratingValue\"]');\n        const countElement = document.querySelector('.review-count, .rating-count, [itemprop=\"reviewCount\"]');\n        \n        let average = 0;\n        let count = 0;\n        const distribution: Record<string, number> = {};\n        \n        if (ratingElement) {\n          const ratingText = ratingElement.textContent?.trim() || '';\n          const ratingValue = ratingElement.getAttribute('data-rating') || \n                             ratingElement.getAttribute('content') || '';\n          \n          if (ratingValue && !isNaN(parseFloat(ratingValue))) {\n            average = parseFloat(ratingValue);\n          } else if (ratingText.match(/[0-5](\\.[0-9])?\\/5/)) {\n            // Format: \"4.5/5\"\n            average = parseFloat(ratingText.split('/')[0]);\n          } else if (ratingText.match(/[0-9](\\.[0-9])?/)) {\n            // Simple number\n            average = parseFloat(ratingText);\n          } else {\n            // Count stars in the element\n            const fullStars = ratingElement.querySelectorAll('.full-star, .star-full, .star.filled').length;\n            const halfStars = ratingElement.querySelectorAll('.half-star, .star-half').length;\n            const totalStars = ratingElement.querySelectorAll('.star, .star-container > *').length || 5;\n            \n            if (fullStars > 0 || halfStars > 0) {\n              average = (fullStars + halfStars * 0.5) / (totalStars / 5);\n            }\n          }\n        }\n        \n        // Find review count\n        if (countElement) {\n          const countText = countElement.textContent?.trim() || '';\n          const countMatch = countText.match(/\\d+/);\n          if (countMatch) {\n            count = parseInt(countMatch[0]);\n          }\n        }\n        \n        // Try to find rating distribution\n        const distributionElements = document.querySelectorAll('.rating-distribution .rating-bar, .rating-breakdown .rating-row');\n        distributionElements.forEach(element => {\n          const stars = element.querySelector('.star-label, .rating-label')?.textContent?.trim() || '';\n          const starMatch = stars.match(/([1-5])\\s+star/i);\n          \n          const countElement = element.querySelector('.count, .rating-count');\n          const countText = countElement?.textContent?.trim() || '';\n          const countMatch = countText.match(/\\d+/);\n          \n          if (starMatch && countMatch) {\n            distribution[starMatch[1]] = parseInt(countMatch[0]);\n          }\n        });\n        \n        return { average, count, distribution: Object.keys(distribution).length > 0 ? distribution : undefined };\n      }, selector);\n      \n      // If we couldn't get an average from the page but have reviews, calculate it\n      if (ratingData.average === 0 && reviews.length > 0) {\n        const totalRating = reviews.reduce((sum, review) => sum + review.rating, 0);\n        ratingData.average = totalRating / reviews.length;\n      }\n      \n      // If we couldn't get a count but have reviews, use the review count\n      if (ratingData.count === 0 && reviews.length > 0) {\n        ratingData.count = reviews.length;\n      }\n      \n      return ratingData;\n    } catch (error) {\n      logger.error(`Error extracting rating: ${error instanceof Error ? error.message : String(error)}`);\n      \n      // Fallback to calculating from reviews\n      if (reviews.length > 0) {\n        const totalRating = reviews.reduce((sum, review) => sum + review.rating, 0);\n        return {\n          average: totalRating / reviews.length,\n          count: reviews.length\n        };\n      }\n      \n      return {\n        average: 0,\n        count: 0\n      };\n    }\n  }\n\n  /**\n   * Extract related products\n   */\n  private async extractRelatedProducts(page: puppeteer.Page, selector: string, maxProducts: number): Promise<ScrapedProduct['relatedProducts']> {\n    try {\n      return await page.evaluate((selector, maxProducts) => {\n        const products: Array<{\n          title: string;\n          url: string;\n          price?: string;\n          imageUrl?: string;\n        }> = [];\n        \n        const productElements = document.querySelectorAll(selector);\n        \n        Array.from(productElements).slice(0, maxProducts).forEach(product => {\n          // Find title and URL (usually in an anchor tag)\n          const linkElement = product.querySelector('a');\n          const titleElement = product.querySelector('.title, .product-title, .name, h3, h4');\n          const priceElement = product.querySelector('.price, .product-price');\n          const imageElement = product.querySelector('img');\n          \n          const title = titleElement?.textContent?.trim() || \n                      linkElement?.getAttribute('title') || \n                      'Related Product';\n                      \n          const url = linkElement?.href || '';\n          const price = priceElement?.textContent?.trim();\n          const imageUrl = imageElement?.src;\n          \n          if (title && url) {\n            products.push({\n              title,\n              url,\n              price,\n              imageUrl\n            });\n          }\n        });\n        \n        return products;\n      }, selector, maxProducts);\n    } catch (error) {\n      logger.error(`Error extracting related products: ${error instanceof Error ? error.message : String(error)}`);\n      return [];\n    }\n  }\n\n  /**\n   * Parse stock status from text\n   */\n  private parseStockStatus(text: string): boolean {\n    if (!text) return true; // Default to in stock if no information\n    \n    const lowercaseText = text.toLowerCase();\n    \n    // Common out of stock indicators\n    const outOfStockIndicators = [\n      'out of stock',\n      'sold out',\n      'unavailable',\n      'no longer available',\n      'not available',\n      'out-of-stock',\n      'not in stock',\n      'backordered'\n    ];\n    \n    for (const indicator of outOfStockIndicators) {\n      if (lowercaseText.includes(indicator)) {\n        return false;\n      }\n    }\n    \n    // Common in stock indicators\n    const inStockIndicators = [\n      'in stock',\n      'available',\n      'in-stock',\n      'ships',\n      'shipping',\n      'add to cart',\n      'buy now',\n      'ship'\n    ];\n    \n    for (const indicator of inStockIndicators) {\n      if (lowercaseText.includes(indicator)) {\n        return true;\n      }\n    }\n    \n    return true; // Default to in stock\n  }\n\n  /**\n   * Parse stock level from text\n   */\n  private parseStockLevel(text: string): string | number | undefined {\n    if (!text) return undefined;\n    \n    const lowercaseText = text.toLowerCase();\n    \n    // Try to find numeric stock level\n    const numericMatch = text.match(/(\\d+)\\s*(left|available|in stock|item)/i);\n    if (numericMatch) {\n      return parseInt(numericMatch[1]);\n    }\n    \n    // Check for stock indicators\n    if (lowercaseText.includes('low stock') || lowercaseText.includes('selling fast')) {\n      return 'LOW';\n    }\n    \n    if (lowercaseText.includes('out of stock') || lowercaseText.includes('sold out')) {\n      return 0;\n    }\n    \n    return undefined;\n  }\n\n  /**\n   * Alternative method to scrape using Axios and Cheerio\n   */\n  async scrapeWithCheerio(): Promise<ScrapedProduct | null> {\n    const targetUrl = this.config.url || 'https://shop.example.com';\n    const selectors = this.config.selectors;\n    const options = this.config.options || {};\n    \n    logger.info(`Starting Cheerio product scrape of ${targetUrl}`);\n    \n    try {\n      // Fetch page content\n      const response = await axios.get(targetUrl, {\n        headers: {\n          'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36',\n          'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',\n          'Accept-Language': 'en-US,en;q=0.5'\n        },\n        timeout: options.timeout || 30000\n      });\n      \n      // Update stats\n      this.stats.pages_visited++;\n      this.stats.bytes_downloaded += response.data.length;\n      \n      // Load HTML with Cheerio\n      const $ = cheerio.load(response.data);\n      logger.info(`Successfully downloaded and parsed ${targetUrl}`);\n      \n      // Extract basic product data\n      const productTitle = $(selectors.productTitle).first().text().trim();\n      const priceText = $(selectors.price).first().text().trim();\n      const description = $(selectors.description).text().trim();\n      const sku = $(selectors.sku).first().text().trim() || \n                 $(selectors.sku).first().attr('content') || \n                 'UNKNOWN';\n      const stockText = $(selectors.stock).first().text().trim();\n      \n      // Parse stock status\n      const inStock = this.parseStockStatus(stockText);\n      \n      // Parse price\n      const price = this.parsePrice(priceText, options.currency);\n      \n      // Extract images\n      const images: ProductImage[] = [];\n      $(selectors.images).slice(0, options.maxImages || 10).each((index, el) => {\n        if ($(el).is('img')) {\n          images.push({\n            url: $(el).attr('src') || '',\n            alt: $(el).attr('alt') || '',\n            isMain: index === 0,\n            thumbnailUrl: $(el).data('thumbnail'),\n            position: index\n          });\n        } else {\n          const img = $(el).find('img').first();\n          if (img.length) {\n            images.push({\n              url: img.attr('src') || '',\n              alt: img.attr('alt') || '',\n              isMain: index === 0,\n              thumbnailUrl: img.data('thumbnail'),\n              position: index\n            });\n          }\n        }\n      });\n      this.stats.images_found += images.length;\n      \n      // Extract variants (simplified for Cheerio)\n      const variants: ProductVariant[] = [];\n      $(selectors.variants).each((index, el) => {\n        const name = $(el).find('label').first().text().trim() || 'Option';\n        const value = $(el).text().trim();\n        const available = !$(el).hasClass('disabled') && !$(el).hasClass('sold-out');\n        \n        if (value) {\n          variants.push({\n            name,\n            value,\n            available,\n            sku: $(el).data('sku')\n          });\n        }\n      });\n      this.stats.variants_found += variants.length;\n      \n      // Extract reviews (simplified for Cheerio)\n      const reviews: ProductReview[] = [];\n      $(selectors.reviews).slice(0, options.maxReviews || 5).each((index, el) => {\n        const author = $(el).find('.author, .reviewer, .user').first().text().trim() || 'Anonymous';\n        const dateText = $(el).find('.date, .review-date').first().text().trim();\n        const title = $(el).find('.title, .review-title').first().text().trim();\n        const text = $(el).find('.text, .content, .review-text').first().text().trim();\n        const ratingText = $(el).find('.rating, .stars').first().text().trim();\n        \n        reviews.push({\n          author,\n          rating: this.parseRating(ratingText),\n          date: dateText || new Date().toISOString().split('T')[0],\n          title: title || undefined,\n          text: text || 'No review text'\n        });\n      });\n      this.stats.reviews_processed += reviews.length;\n      \n      // Extract rating\n      const ratingText = $(selectors.rating).first().text().trim();\n      const ratingValue = $(selectors.rating).first().data('rating') || \n                         $(selectors.rating).first().attr('content');\n      \n      let ratingAverage = 0;\n      if (ratingValue !== undefined && !isNaN(parseFloat(String(ratingValue)))) {\n        ratingAverage = parseFloat(String(ratingValue));\n      } else {\n        ratingAverage = this.parseRating(ratingText);\n      }\n      \n      const ratingCount = parseInt(\n        $('.review-count, .rating-count').text().replace(/[^\\d]/g, '') || '0'\n      );\n      \n      // Extract related products (simplified for Cheerio)\n      const relatedProducts: ScrapedProduct['relatedProducts'] = [];\n      $(selectors.relatedProducts || '.related-products .product').slice(0, options.maxRelatedProducts || 5).each((index, el) => {\n        const title = $(el).find('.title, .product-title, .name').first().text().trim();\n        const linkElement = $(el).find('a').first();\n        const url = linkElement.attr('href') || '';\n        const price = $(el).find('.price, .product-price').first().text().trim();\n        const imageUrl = $(el).find('img').first().attr('src');\n        \n        if (title && url) {\n          relatedProducts.push({\n            title,\n            url: url.startsWith('http') ? url : new URL(url, targetUrl).toString(),\n            price,\n            imageUrl\n          });\n        }\n      });\n      this.stats.related_products_found += relatedProducts.length;\n      \n      // Create short description (first 200 chars)\n      const shortDescription = description.length > 200 \n        ? description.substring(0, 200).trim() + '...'\n        : description;\n      \n      // Create product object\n      const product: ScrapedProduct = {\n        title: productTitle || 'Unknown Product',\n        url: targetUrl,\n        sku,\n        description,\n        shortDescription,\n        price,\n        images,\n        variants,\n        reviews,\n        rating: {\n          average: ratingAverage,\n          count: ratingCount || reviews.length,\n        },\n        metadata: {\n          inStock,\n          stockLevel: this.parseStockLevel(stockText),\n          tags: []\n        },\n        relatedProducts,\n        timestamp: new Date().toISOString()\n      };\n      \n      // Update stats\n      this.stats.products_scraped++;\n      logger.info(`Successfully scraped product: ${product.title}`);\n      \n      return product;\n    } catch (error) {\n      this.stats.errors++;\n      logger.error(`Cheerio scraping error: ${error instanceof Error ? error.message : String(error)}`);\n      if (error instanceof Error && error.stack) {\n        logger.error(`Stack trace: ${error.stack}`);\n      }\n      return null;\n    }\n  }\n\n  /**\n   * Save the scraped product data to files\n   * @param product The scraped product\n   */\n  async saveData(product: ScrapedProduct | null): Promise<void> {\n    if (!product) {\n      logger.warn('No product to save');\n      return;\n    }\n    \n    try {\n      // Validate product against schema\n      try {\n        ScrapedProductSchema.parse(product);\n        logger.info('Product validation successful');\n      } catch (error) {\n        logger.warn(`Product validation failed: ${error instanceof Error ? error.message : String(error)}`);\n      }\n      \n      // Save as JSON\n      const dataFile = path.join(this.outputPaths.data, 'product.json');\n      fs.writeFileSync(dataFile, JSON.stringify(product, null, 2));\n      \n      // Create a simplified version for export\n      const simpleProduct = {\n        title: product.title,\n        url: product.url,\n        sku: product.sku,\n        price: product.price.formatted,\n        description: product.shortDescription,\n        inStock: product.metadata.inStock ? 'Yes' : 'No',\n        images: product.images.length,\n        variants: product.variants.map(v => `${v.name}: ${v.value}`).join(', '),\n        rating: `${product.rating.average}/5 (${product.rating.count} reviews)`\n      };\n      \n      // Save as CSV\n      const exportFile = path.join(this.outputPaths.exports, 'product.csv');\n      fs.writeFileSync(exportFile, \n        Object.keys(simpleProduct).join(',') + '\\n' +\n        Object.values(simpleProduct).map(v => `\"${String(v).replace(/\"/g, '\"\"')}\"`).join(',')\n      );\n      \n      // Save individual images data\n      const imagesDir = path.join(this.outputPaths.data, 'images');\n      if (!fs.existsSync(imagesDir)) {\n        fs.mkdirSync(imagesDir, { recursive: true });\n      }\n      \n      fs.writeFileSync(\n        path.join(imagesDir, 'images.json'),\n        JSON.stringify(product.images, null, 2)\n      );\n      \n      // Save variants data\n      const variantsDir = path.join(this.outputPaths.data, 'variants');\n      if (!fs.existsSync(variantsDir)) {\n        fs.mkdirSync(variantsDir, { recursive: true });\n      }\n      \n      fs.writeFileSync(\n        path.join(variantsDir, 'variants.json'),\n        JSON.stringify(product.variants, null, 2)\n      );\n      \n      // Save reviews data\n      if (product.reviews.length > 0) {\n        const reviewsDir = path.join(this.outputPaths.data, 'reviews');\n        if (!fs.existsSync(reviewsDir)) {\n          fs.mkdirSync(reviewsDir, { recursive: true });\n        }\n        \n        fs.writeFileSync(\n          path.join(reviewsDir, 'reviews.json'),\n          JSON.stringify(product.reviews, null, 2)\n        );\n      }\n      \n      logger.info(`Saved product data to ${dataFile} and exported to ${exportFile}`);\n    } catch (error) {\n      this.stats.errors++;\n      logger.error(`Error saving data: ${error instanceof Error ? error.message : String(error)}`);\n    }\n  }\n\n  /**\n   * Generate a report of the scraping process\n   * @returns Scraper statistics\n   */\n  generateReport(): ScraperStats {\n    // Calculate elapsed time\n    const startTime = new Date(this.stats.start_time);\n    const endTime = new Date();\n    const elapsed = (endTime.getTime() - startTime.getTime()) / 1000;\n    \n    // Update final stats\n    this.stats.end_time = endTime.toISOString();\n    this.stats.elapsed_seconds = elapsed;\n    \n    // Save report\n    const reportFile = path.join(this.outputPaths.data, 'report.json');\n    fs.writeFileSync(reportFile, JSON.stringify(this.stats, null, 2));\n    \n    logger.info(`Generated scraping report: ${reportFile}`);\n    return this.stats;\n  }\n}\n\n/**\n * Main function to run the scraper\n * @param config Scraper configuration\n * @param outputPaths Output directory paths\n * @returns Promise resolving to scraper results\n */\nasync function run(config: ScraperConfig, outputPaths: OutputPaths): Promise<ScraperResult> {\n  try {\n    // Initialize and run the scraper\n    const scraper = new ProductScraper(config, outputPaths);\n    \n    // Choose scraping method based on complexity\n    const usePuppeteer = true; // Default to Puppeteer for product scraping\n    const product = usePuppeteer ? \n      await scraper.scrapeWithPuppeteer() : \n      await scraper.scrapeWithCheerio();\n    \n    await scraper.saveData(product);\n    const stats = scraper.generateReport();\n    \n    return {\n      success: product !== null,\n      items_scraped: product ? 1 : 0,\n      stats\n    };\n  } catch (error) {\n    logger.error(`Error running product scraper: ${error instanceof Error ? error.message : String(error)}`);\n    if (error instanceof Error && error.stack) {\n      logger.error(`Stack trace: ${error.stack}`);\n    }\n    \n    return {\n      success: false,\n      items_scraped: 0,\n      stats: {\n        start_time: new Date().toISOString(),\n        pages_visited: 0,\n        products_scraped: 0,\n        images_found: 0,\n        variants_found: 0,\n        reviews_processed: 0,\n        related_products_found: 0,\n        errors: 1,\n        bytes_downloaded: 0\n      },\n      error: error instanceof Error ? error.message : String(error)\n    };\n  }\n}\n\n/**\n * Command-line entry point\n */\nasync function main() {\n  // Parse command line arguments\n  const argv = yargs(hideBin(process.argv))\n    .option('config', {\n      alias: 'c',\n      type: 'string',\n      description: 'Path to configuration file'\n    })\n    .option('output', {\n      alias: 'o',\n      type: 'string',\n      description: 'Output directory',\n      default: './output'\n    })\n    .option('url', {\n      alias: 'u',\n      type: 'string',\n      description: 'URL to scrape',\n      default: 'https://shop.example.com'\n    })\n    .help()\n    .alias('help', 'h')\n    .parseSync();\n\n  try {\n    // Load config from file or use defaults\n    let config: ScraperConfig;\n    \n    if (argv.config && typeof argv.config === 'string' && fs.existsSync(argv.config)) {\n      const configContent = fs.readFileSync(argv.config, 'utf8');\n      const ext = path.extname(argv.config).toLowerCase();\n      \n      if (ext === '.json') {\n        config = JSON.parse(configContent);\n      } else if (ext === '.yaml' || ext === '.yml') {\n        config = yaml.parse(configContent);\n      } else {\n        throw new Error(`Unsupported config file format: ${ext}`);\n      }\n    } else {\n      // Use default configuration\n      config = {\n        url: typeof argv.url === 'string' ? argv.url : 'https://shop.example.com',\n        selectors: {\n          productTitle: 'h1.product-title, .product-title h1, .product-name h1',\n          price: '.product-price, .price, .current-price',\n          description: '.product-description, .description, [itemprop=\"description\"]',\n          images: '.product-images img, .product-gallery img, .product-image',\n          variants: '.product-variants, .product-options, .variants',\n          reviews: '.product-review, .review, .customer-review',\n          rating: '.product-rating, .rating, [itemprop=\"ratingValue\"]',\n          sku: '.product-sku, .sku, [itemprop=\"sku\"]',\n          stock: '.stock-status, .availability, .in-stock'\n        },\n        options: {\n          maxRelatedProducts: 5,\n          maxReviews: 10,\n          maxImages: 10,\n          delay: 1000,\n          timeout: 30000,\n          headless: true,\n          currency: 'USD',\n          scrollToBottom: true,\n          waitForNetworkIdle: true\n        }\n      };\n    }\n    \n    // Create output paths\n    const outputBase = typeof argv.output === 'string' ? argv.output : './output';\n    const outputPaths: OutputPaths = {\n      data: path.join(outputBase, 'data'),\n      exports: path.join(outputBase, 'exports'),\n      schemas: path.join(outputBase, 'schemas')\n    };\n    \n    // Run the scraper\n    logger.info('Starting product scraper...');\n    const result = await run(config, outputPaths);\n    \n    // Output result\n    console.log(JSON.stringify(result, null, 2));\n    \n    // Return success status\n    process.exit(result.success ? 0 : 1);\n  } catch (error) {\n    logger.error(`Error: ${error instanceof Error ? error.message : String(error)}`);\n    process.exit(1);\n  }\n}\n\n// Run the main function if executed directly\nif (require.main === module) {\n  main().catch(error => {\n    console.error(`Fatal error: ${error instanceof Error ? error.message : String(error)}`);\n    process.exit(1);\n  });\n}\n\n// Export the run function for importing in other modules\nexport { run, ScraperConfig, OutputPaths, ScraperResult };\n\n"]}